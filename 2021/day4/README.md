this could be the most spaghetti code I have ever written - I need to go to bed